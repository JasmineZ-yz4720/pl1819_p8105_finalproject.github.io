<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Data Sources</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="introduction.html">Introduction</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="data_source.html">Data Sources</a>
</li>
<li>
  <a href="analysis.html">Exploratory Analysis</a>
</li>
<li>
  <a href="regression.html">Regression</a>
</li>
<li>
  <a href="project_report.html">Project Report</a>
</li>
<li>
  <a href="mailto:&lt;yz4720@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/JasmineZ-yz4720/pl1819_p8105_finalproject.github.io.git">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Data Sources</h1>

</div>


<div id="source-1-match-statistic-summary" class="section level1">
<h1><strong>Source 1: Match Statistic Summary</strong></h1>
<p>The dataset of <a
href="https://www.kaggle.com/datasets/thesiff/premierleague1819/">match
statistics</a> was downloaded and read in. It includes different
measures of game statistics for 20 teams in Premier League of season
2018-19. Our intended outcome value is
<code>general_goal_difference</code>, which is measured by the goal
scored minus goal conceded. Variables of measure include basic
information about the squad, total fouls received, goal stats, attack
stats, defense stats, possession rate, and TV revenue. We selected the
variables of interest: <code>general_goal_difference</code>,
<code>general_squad_average_age</code>, <code>attack_posession</code>,
<code>attack_pass_accuracy</code>, <code>general_card_yellow</code>.</p>
<p>Teams are ordered by the final league position, from 1 to 20. It can
be observed that higher ranked teams have positive goal difference,
while lower ranked teams have negative goal difference. The seperation
between positive and negative goal difference happens about rank 10 so
that we decide <code>general_goal_difference</code> is an accurate
representation of the team performance outcome.</p>
<pre class="r"><code>match_df = read_csv(&quot;./data/match_data.csv&quot;)|&gt; 
  janitor::clean_names() |&gt; 
  select(team, general_league_position, general_goal_difference, general_squad_average_age, attack_posession, 
         attack_pass_accuracy, general_card_yellow)
match_df |&gt; 
  knitr::kable()</code></pre>
<table>
<colgroup>
<col width="12%" />
<col width="16%" />
<col width="16%" />
<col width="17%" />
<col width="11%" />
<col width="14%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">team</th>
<th align="right">general_league_position</th>
<th align="right">general_goal_difference</th>
<th align="right">general_squad_average_age</th>
<th align="right">attack_posession</th>
<th align="right">attack_pass_accuracy</th>
<th align="right">general_card_yellow</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Manchester City</td>
<td align="right">1</td>
<td align="right">72</td>
<td align="right">27.1</td>
<td align="right">64.0</td>
<td align="right">89.0</td>
<td align="right">44</td>
</tr>
<tr class="even">
<td align="left">Liverpool</td>
<td align="right">2</td>
<td align="right">67</td>
<td align="right">26.8</td>
<td align="right">58.8</td>
<td align="right">84.4</td>
<td align="right">38</td>
</tr>
<tr class="odd">
<td align="left">Chelsea</td>
<td align="right">3</td>
<td align="right">24</td>
<td align="right">28.1</td>
<td align="right">59.9</td>
<td align="right">87.6</td>
<td align="right">49</td>
</tr>
<tr class="even">
<td align="left">Tottenham</td>
<td align="right">4</td>
<td align="right">28</td>
<td align="right">27.0</td>
<td align="right">56.7</td>
<td align="right">83.2</td>
<td align="right">56</td>
</tr>
<tr class="odd">
<td align="left">Arsenal</td>
<td align="right">5</td>
<td align="right">22</td>
<td align="right">27.5</td>
<td align="right">56.1</td>
<td align="right">83.3</td>
<td align="right">72</td>
</tr>
<tr class="even">
<td align="left">Manchester United</td>
<td align="right">6</td>
<td align="right">11</td>
<td align="right">27.3</td>
<td align="right">53.3</td>
<td align="right">82.3</td>
<td align="right">73</td>
</tr>
<tr class="odd">
<td align="left">Wolverhampton</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">27.2</td>
<td align="right">47.4</td>
<td align="right">78.2</td>
<td align="right">72</td>
</tr>
<tr class="even">
<td align="left">Everton</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">27.0</td>
<td align="right">51.0</td>
<td align="right">77.3</td>
<td align="right">55</td>
</tr>
<tr class="odd">
<td align="left">Leicester</td>
<td align="right">9</td>
<td align="right">3</td>
<td align="right">29.0</td>
<td align="right">50.8</td>
<td align="right">79.2</td>
<td align="right">57</td>
</tr>
<tr class="even">
<td align="left">West Ham</td>
<td align="right">10</td>
<td align="right">-3</td>
<td align="right">28.3</td>
<td align="right">49.0</td>
<td align="right">78.7</td>
<td align="right">59</td>
</tr>
<tr class="odd">
<td align="left">Watford</td>
<td align="right">11</td>
<td align="right">-7</td>
<td align="right">26.8</td>
<td align="right">47.4</td>
<td align="right">76.1</td>
<td align="right">77</td>
</tr>
<tr class="even">
<td align="left">Crystal Palace</td>
<td align="right">12</td>
<td align="right">-2</td>
<td align="right">26.8</td>
<td align="right">46.6</td>
<td align="right">76.8</td>
<td align="right">58</td>
</tr>
<tr class="odd">
<td align="left">Newcastle</td>
<td align="right">13</td>
<td align="right">-6</td>
<td align="right">26.1</td>
<td align="right">42.9</td>
<td align="right">72.9</td>
<td align="right">57</td>
</tr>
<tr class="even">
<td align="left">Bournemouth</td>
<td align="right">14</td>
<td align="right">-14</td>
<td align="right">26.2</td>
<td align="right">47.7</td>
<td align="right">78.1</td>
<td align="right">60</td>
</tr>
<tr class="odd">
<td align="left">Burnley</td>
<td align="right">15</td>
<td align="right">-23</td>
<td align="right">27.3</td>
<td align="right">43.4</td>
<td align="right">70.3</td>
<td align="right">75</td>
</tr>
<tr class="even">
<td align="left">Southampton</td>
<td align="right">16</td>
<td align="right">-20</td>
<td align="right">28.0</td>
<td align="right">45.4</td>
<td align="right">74.0</td>
<td align="right">71</td>
</tr>
<tr class="odd">
<td align="left">Brighton</td>
<td align="right">17</td>
<td align="right">-25</td>
<td align="right">28.4</td>
<td align="right">44.1</td>
<td align="right">74.8</td>
<td align="right">60</td>
</tr>
<tr class="even">
<td align="left">Cardiff</td>
<td align="right">18</td>
<td align="right">-35</td>
<td align="right">29.7</td>
<td align="right">39.1</td>
<td align="right">63.9</td>
<td align="right">66</td>
</tr>
<tr class="odd">
<td align="left">Fulham</td>
<td align="right">19</td>
<td align="right">-47</td>
<td align="right">26.7</td>
<td align="right">49.2</td>
<td align="right">80.3</td>
<td align="right">68</td>
</tr>
<tr class="even">
<td align="left">Huddersfield</td>
<td align="right">20</td>
<td align="right">-54</td>
<td align="right">28.5</td>
<td align="right">47.1</td>
<td align="right">75.8</td>
<td align="right">55</td>
</tr>
</tbody>
</table>
</div>
<div id="source-2-player-statistic-age" class="section level1">
<h1><strong>Source 2: Player Statistic (Age)</strong></h1>
<p>The dataset of <a
href="https://fbref.com/en/comps/9/2018-2019/stats/2018-2019-Premier-League-Stats#all_stats_standard">player
statistics</a> was extracted and read in. Variables of interest are
selected, including player’s nation, team, age, and total minutes played
during the season. Team names are modified so that they match with
<code>match_df</code>, preparing for further datasets merging. Below
shows a couple player entries.</p>
<pre class="r"><code>player_df = read_excel(&quot;./data/player_game.xlsx&quot;, sheet = 1) |&gt; 
  janitor::clean_names()|&gt;
  rename(team = squad)|&gt; 
  select(player, nation, team, age)
player_df$team = gsub(&quot;Manchester Utd&quot;, &quot;Manchester United&quot;, player_df$team)
player_df$team = gsub(&quot;Newcastle Utd&quot;, &quot;Newcastle&quot;, player_df$team)
player_df$team = gsub(&quot;Wolves&quot;, &quot;Wolverhampton&quot;, player_df$team)
player_df$team = gsub(&quot;Cardiff City&quot;, &quot;Cardiff&quot;, player_df$team)
player_df$team = gsub(&quot;Leicester City&quot;, &quot;Leicester&quot;, player_df$team)

player_df |&gt;
  head(5) |&gt; 
  knitr::kable() </code></pre>
<table>
<thead>
<tr class="header">
<th align="left">player</th>
<th align="left">nation</th>
<th align="left">team</th>
<th align="left">age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Patrick van Aanholt</td>
<td align="left">nl NED</td>
<td align="left">Crystal Palace</td>
<td align="left">27</td>
</tr>
<tr class="even">
<td align="left">Sergio Agüero</td>
<td align="left">ar ARG</td>
<td align="left">Manchester City</td>
<td align="left">30</td>
</tr>
<tr class="odd">
<td align="left">Nathan Aké</td>
<td align="left">nl NED</td>
<td align="left">Bournemouth</td>
<td align="left">23</td>
</tr>
<tr class="even">
<td align="left">Marc Albrighton</td>
<td align="left">eng ENG</td>
<td align="left">Leicester</td>
<td align="left">28</td>
</tr>
<tr class="odd">
<td align="left">Toby Alderweireld</td>
<td align="left">be BEL</td>
<td align="left">Tottenham</td>
<td align="left">29</td>
</tr>
</tbody>
</table>
<p>Using <code>player_df</code>, we changed the <code>age</code>
variable to number so that we could calculate the 25th and 75th
percentile of age distribution, which is 23 and 29 years old. Then we
calculated the proportion of players that belong to the age range of 23
to 29 years old, grouped by 20 different teams. We merged the
<code>ave_age_proportion</code> variable into <code>match_df</code>
using <code>left_join.</code> Belows shows the result for the top 5
teams.</p>
<pre class="r"><code>age_player_df = player_df  |&gt; 
 mutate(age = as.numeric(as.character(age))) |&gt; 
 na.omit()
q25 &lt;- quantile(age_player_df$age, 0.25)
q75 &lt;- quantile(age_player_df$age, 0.75)

proportion_age_23_29 &lt;- age_player_df  |&gt; 
  group_by(team) |&gt;                       
  summarise(
    total = n(),                           
    count_23_29 = sum(age &gt;= 23 &amp; age &lt;= 29))  |&gt; 
  mutate(proportion = count_23_29 / total)

match_df = match_df  |&gt; 
  left_join(proportion_age_23_29, by = &quot;team&quot;)  |&gt; 
  select(-total, -count_23_29)  |&gt; 
  rename(ave_age_proportion=proportion)

match_df|&gt;
  head(5) |&gt; 
  knitr::kable()</code></pre>
<table>
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="14%" />
<col width="15%" />
<col width="10%" />
<col width="12%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">team</th>
<th align="right">general_league_position</th>
<th align="right">general_goal_difference</th>
<th align="right">general_squad_average_age</th>
<th align="right">attack_posession</th>
<th align="right">attack_pass_accuracy</th>
<th align="right">general_card_yellow</th>
<th align="right">ave_age_proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Manchester City</td>
<td align="right">1</td>
<td align="right">72</td>
<td align="right">27.1</td>
<td align="right">64.0</td>
<td align="right">89.0</td>
<td align="right">44</td>
<td align="right">0.5714286</td>
</tr>
<tr class="even">
<td align="left">Liverpool</td>
<td align="right">2</td>
<td align="right">67</td>
<td align="right">26.8</td>
<td align="right">58.8</td>
<td align="right">84.4</td>
<td align="right">38</td>
<td align="right">0.7826087</td>
</tr>
<tr class="odd">
<td align="left">Chelsea</td>
<td align="right">3</td>
<td align="right">24</td>
<td align="right">28.1</td>
<td align="right">59.9</td>
<td align="right">87.6</td>
<td align="right">49</td>
<td align="right">0.5833333</td>
</tr>
<tr class="even">
<td align="left">Tottenham</td>
<td align="right">4</td>
<td align="right">28</td>
<td align="right">27.0</td>
<td align="right">56.7</td>
<td align="right">83.2</td>
<td align="right">56</td>
<td align="right">0.5714286</td>
</tr>
<tr class="odd">
<td align="left">Arsenal</td>
<td align="right">5</td>
<td align="right">22</td>
<td align="right">27.5</td>
<td align="right">56.1</td>
<td align="right">83.3</td>
<td align="right">72</td>
<td align="right">0.5000000</td>
</tr>
</tbody>
</table>
</div>
<div id="source-3-player-statistic-country-region"
class="section level1">
<h1><strong>Source 3: Player Statistic (Country, Region)</strong></h1>
<p><code>player_df</code> has variable <code>country</code>, which is
where each player comes from. Dataset of <a
href="https://github.com/datasets/country-codes/blob/master/data/country-codes.csv">country
codes</a> was downloaded and read in. <code>country_code_df</code> is
manipulated so that Great Britain is separated into
<code>ENG, NIR, SCO, WAL</code>. Variables include the country name,
country code, and the region that country belongs to. Belows shows 5
entries of cleaned <code>country_code_df</code>.</p>
<pre class="r"><code>country_code_df = read.csv(&quot;./data/country_codes.csv&quot;) |&gt; 
  janitor::clean_names() |&gt; 
  rename(country = fifa) 
GBR_df = country_code_df |&gt; 
  filter(country == &quot;ENG,NIR,SCO,WAL&quot;) 
GBR_df = data.frame(country = unlist(strsplit(as.character(GBR_df$country), &quot;,&quot;)),
                    official_name_en = GBR_df$official_name_en,
                    region_name = GBR_df$region_name)
country_code_df = country_code_df |&gt; 
  select(country, official_name_en, region_name) |&gt; 
  bind_rows(GBR_df)

country_code_df|&gt;
  head(5) |&gt; 
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="left">official_name_en</th>
<th align="left">region_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TPE</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">AFG</td>
<td align="left">Afghanistan</td>
<td align="left">Asia</td>
</tr>
<tr class="odd">
<td align="left">ALB</td>
<td align="left">Albania</td>
<td align="left">Europe</td>
</tr>
<tr class="even">
<td align="left">ALG</td>
<td align="left">Algeria</td>
<td align="left">Africa</td>
</tr>
<tr class="odd">
<td align="left">ASA</td>
<td align="left">American Samoa</td>
<td align="left">Oceania</td>
</tr>
</tbody>
</table>
<p><code>player_df</code> is manipulated so that country origin for each
player is saved as a variable. Then the dataset is merged by
<code>country_code_df</code> and each player has a new variable
indicating the region he comes from. Then the proportion of European
players is calculated for each team and the variable
<code>europe_player_proportion</code> is added to <code>match_df</code>
by merging the datasets. Below shows the result of the dataframe for the
top 5 teams.</p>
<pre class="r"><code>player_dist = player_df |&gt;
  separate(nation, into = c(&quot;country_abbre&quot;, &quot;country&quot;), convert = TRUE) |&gt; 
  select(country, player, team) |&gt; 
  left_join(x = _, y = country_code_df) |&gt; 
  drop_na()
player_dist$team &lt;- factor(player_dist$team, levels = unique(player_dist$team), 
                           labels = c(&quot;Manchester City&quot;, &quot;Liverpool&quot;, &quot;Chelsea&quot;, &quot;Tottenham&quot;, &quot;Arsenal&quot;, &quot;Manchester United&quot;,
                                      &quot;Wolverhampton&quot;, &quot;Everton&quot;, &quot;Leicester&quot;, &quot;West Ham&quot;, &quot;Watford&quot;, &quot;Crystal Palace&quot;, 
                                      &quot;Newcastle&quot;, &quot;Bournemouth&quot;, &quot;Burnley&quot;, &quot;Southampton&quot;, &quot;Brighton&quot;, &quot;Cardiff&quot;, &quot;Fulham&quot;, 
                                      &quot;Huddersfield&quot;))

player_region = player_dist |&gt;
  group_by(team) |&gt;                       
  summarise(
    total = n()) 
player_europe = player_dist |&gt;
  filter(region_name == &quot;Europe&quot;) |&gt; 
  group_by(team) |&gt;                       
  summarise(
    n_europe = n()) |&gt; 
  left_join(x = _, y = player_region) |&gt; 
  mutate(proportion = n_europe/total)

match_df = match_df  |&gt; 
  left_join(player_europe, by = &quot;team&quot;)  |&gt; 
  select(-total, -n_europe)  |&gt; 
  rename(europe_player_proportion = proportion)
match_df|&gt;
  head(5) |&gt; 
  knitr::kable()</code></pre>
<table>
<colgroup>
<col width="8%" />
<col width="12%" />
<col width="12%" />
<col width="13%" />
<col width="8%" />
<col width="10%" />
<col width="10%" />
<col width="9%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">team</th>
<th align="right">general_league_position</th>
<th align="right">general_goal_difference</th>
<th align="right">general_squad_average_age</th>
<th align="right">attack_posession</th>
<th align="right">attack_pass_accuracy</th>
<th align="right">general_card_yellow</th>
<th align="right">ave_age_proportion</th>
<th align="right">europe_player_proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Manchester City</td>
<td align="right">1</td>
<td align="right">72</td>
<td align="right">27.1</td>
<td align="right">64.0</td>
<td align="right">89.0</td>
<td align="right">44</td>
<td align="right">0.5714286</td>
<td align="right">0.7307692</td>
</tr>
<tr class="even">
<td align="left">Liverpool</td>
<td align="right">2</td>
<td align="right">67</td>
<td align="right">26.8</td>
<td align="right">58.8</td>
<td align="right">84.4</td>
<td align="right">38</td>
<td align="right">0.7826087</td>
<td align="right">0.6666667</td>
</tr>
<tr class="odd">
<td align="left">Chelsea</td>
<td align="right">3</td>
<td align="right">24</td>
<td align="right">28.1</td>
<td align="right">59.9</td>
<td align="right">87.6</td>
<td align="right">49</td>
<td align="right">0.5833333</td>
<td align="right">0.9285714</td>
</tr>
<tr class="even">
<td align="left">Tottenham</td>
<td align="right">4</td>
<td align="right">28</td>
<td align="right">27.0</td>
<td align="right">56.7</td>
<td align="right">83.2</td>
<td align="right">56</td>
<td align="right">0.5714286</td>
<td align="right">0.6000000</td>
</tr>
<tr class="odd">
<td align="left">Arsenal</td>
<td align="right">5</td>
<td align="right">22</td>
<td align="right">27.5</td>
<td align="right">56.1</td>
<td align="right">83.3</td>
<td align="right">72</td>
<td align="right">0.5000000</td>
<td align="right">0.6785714</td>
</tr>
</tbody>
</table>
</div>
<div id="source-4-transfer-market-spending" class="section level1">
<h1><strong>Source 4: Transfer Market Spending</strong></h1>
<p>The dataset of <a
href="https://www.kaggle.com/datasets/thesiff/premierleague1819/">spending
in the transfer market</a> is downloaded and read in.
<code>transfer_df</code> includes variables indicating net spending for
each year from 2009 to 2019, and the total net spending over the past
decade. We are interested in exploring the relationship between total
net spending and team performance so these two variables are selected
and merged into <code>match_df</code> for analysis. Below shows the
result of our final cleaned <code>match_df</code> for top 5 teams.</p>
<pre class="r"><code>transfer_df = read_csv(&quot;./data/transfer.csv&quot;)|&gt; 
  janitor::clean_names() 
transfer_df$team &lt;- factor(transfer_df$team, levels = unique(transfer_df$team), 
                           labels = c(&quot;Manchester City&quot;, &quot;Liverpool&quot;, &quot;Chelsea&quot;, &quot;Tottenham&quot;, &quot;Arsenal&quot;, &quot;Manchester United&quot;,
                                      &quot;Wolverhampton&quot;, &quot;Everton&quot;, &quot;Leicester&quot;, &quot;West Ham&quot;, &quot;Watford&quot;, &quot;Crystal Palace&quot;, 
                                      &quot;Newcastle&quot;, &quot;Bournemouth&quot;, &quot;Burnley&quot;, &quot;Southampton&quot;, &quot;Brighton&quot;, &quot;Cardiff&quot;, &quot;Fulham&quot;, 
                                      &quot;Huddersfield&quot;))
transfer_df = transfer_df |&gt; 
  select(team, total)
match_df = match_df  |&gt; 
  left_join(transfer_df, by = &quot;team&quot;) 

match_df|&gt;
  head(5) |&gt; 
  knitr::kable()</code></pre>
<table style="width:100%;">
<colgroup>
<col width="7%" />
<col width="11%" />
<col width="11%" />
<col width="12%" />
<col width="8%" />
<col width="10%" />
<col width="9%" />
<col width="9%" />
<col width="12%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">team</th>
<th align="right">general_league_position</th>
<th align="right">general_goal_difference</th>
<th align="right">general_squad_average_age</th>
<th align="right">attack_posession</th>
<th align="right">attack_pass_accuracy</th>
<th align="right">general_card_yellow</th>
<th align="right">ave_age_proportion</th>
<th align="right">europe_player_proportion</th>
<th align="right">total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Manchester City</td>
<td align="right">1</td>
<td align="right">72</td>
<td align="right">27.1</td>
<td align="right">64.0</td>
<td align="right">89.0</td>
<td align="right">44</td>
<td align="right">0.5714286</td>
<td align="right">0.7307692</td>
<td align="right">-1070.83</td>
</tr>
<tr class="even">
<td align="left">Liverpool</td>
<td align="right">2</td>
<td align="right">67</td>
<td align="right">26.8</td>
<td align="right">58.8</td>
<td align="right">84.4</td>
<td align="right">38</td>
<td align="right">0.7826087</td>
<td align="right">0.6666667</td>
<td align="right">-666.55</td>
</tr>
<tr class="odd">
<td align="left">Chelsea</td>
<td align="right">3</td>
<td align="right">24</td>
<td align="right">28.1</td>
<td align="right">59.9</td>
<td align="right">87.6</td>
<td align="right">49</td>
<td align="right">0.5833333</td>
<td align="right">0.9285714</td>
<td align="right">-16.78</td>
</tr>
<tr class="even">
<td align="left">Tottenham</td>
<td align="right">4</td>
<td align="right">28</td>
<td align="right">27.0</td>
<td align="right">56.7</td>
<td align="right">83.2</td>
<td align="right">56</td>
<td align="right">0.5714286</td>
<td align="right">0.6000000</td>
<td align="right">-324.86</td>
</tr>
<tr class="odd">
<td align="left">Arsenal</td>
<td align="right">5</td>
<td align="right">22</td>
<td align="right">27.5</td>
<td align="right">56.1</td>
<td align="right">83.3</td>
<td align="right">72</td>
<td align="right">0.5000000</td>
<td align="right">0.6785714</td>
<td align="right">-560.93</td>
</tr>
</tbody>
</table>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
